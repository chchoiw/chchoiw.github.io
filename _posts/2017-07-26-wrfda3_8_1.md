---
title: 'WRFDA 3.8.1'
date: 2017-07-26
permalink: /posts/2017/07/wrfda_3.8.1/
tags:
  - WRFDA
  - WRF
---

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

* [Run real cases](#run-real-cases)
	* [A. link files to $WRKDIR/be.dat:](#a-link-files-to-wrkdirbedat)
	* [B. vi namelist.input](#b-vi-namelistinput)
	* [C.  Run da_wrfvar.exe](#c-run-da_wrfvarexe)
	* [D. check rsl.error.0000 and rsl.out.0000](#d-check-rslerror0000-and-rslout0000)
* [About be.dat](#about-bedat)
	* [A.  be.dat.cv3](#a-bedatcv3)
	* [B.  other be.dat](#b-other-bedat)
	* [C.  running  gen_be_wrapper.ksh](#c-running-gen_be_wrapperksh)
		* [i).  link](#i-link)
		* [ii).  vi gen_be_wrapper.ksh](#ii-vi-gen_be_wrapperksh)

<!-- /code_chunk_output -->

## Run real cases
Install WRFDA directory is \$WRFDA

my working directory is \$WRKDIR/wrfda









### A. link files to $WRKDIR/be.dat: 


```bash
 cp $DAT_DIR/namelist.input.3dvar ./namelist.input
 ln -sf $WRFDA/run/LANDUSE.TBL .
 ln -sf $WRFDA/var/da/da_wrfvar.exe .
 
 ln -sf $WRKDIR/obs/obs_gts_2017-06-12_12:00:00.3DVAR ./ob.ascii
 ln -sf $WRKDIR/wrf/wrfinput_d01 ./fg
```
The above files are the ouputs of the following processes:
- fg=wrfinput_d01 :  [Run WPS(NMM)](https://chchoiw.blogspot.com/2017/07/run-wps-for-nmm.html) (or [ARW](https://chchoiw.blogspot.com/2017/07/run-wps-for-arw.html))

- ob.ascii : [MADIS to little_r](https://chchoiw.blogspot.com/2017/07/wrf-run-obsprocexe.html) or [WRFDA â€“ LIITLE_R](https://chchoiw.wordpress.com/2017/08/03/wrf-liitle_r/)

- radar.ascii : [WRFDA (Py-Art and Radar)](https://chchoiw.blogspot.com/2017/08/wrfda-py-art-and-radar.html)

LANDUSE.TBL

namelist.input








### B. vi namelist.input

```bash
  &wrfvar7
 cv_options=3,
 /
 &wrfvar18
 analysis_date="2017-06-12_12:00:00.0000",
 /
 &wrfvar19
 /
 &wrfvar20
 /
 &wrfvar21
 time_window_min="2017-06-12_06:00:00.0000",
 /
 &wrfvar22
 time_window_max="2017-06-13_00:00:00.0000",
 /
 &time_control
 start_year=2017,
 start_month=06,
 start_day=12,
 start_hour=12,
 end_year=2017,
 end_month=06,
 end_day=12,
 end_hour=17,
 /
 &fdda
 /
 &domains
 e_we=50,
 e_sn=50,
 e_vert=30,
 dx=16000,
 dy=16000,
 / 
 
 
 &physics
 mp_physics=3,
 ra_lw_physics=1,
 ra_sw_physics=1,
 radt=60,
 sf_sfclay_physics=1,
 sf_surface_physics=1,
 bl_pbl_physics=1,
 cu_physics=1,
 cudt=5,
 num_soil_layers=4,
 mp_zero_out=2,
 co2tf=0,
 num_land_cat=24,
 SF_SURFACE_PHYSICS = 2,

```






### C.  Run da_wrfvar.exe


./da_wrfvar.exe








### D. check rsl.error.0000 and rsl.out.0000


## About be.dat

### A.  be.dat.cv3 
be.dat.cv3 is in $WRFDA/var/run/be.dat.cv3


### B.  other be.dat 
 Other be.dat is generated by $WRFDA/var/scripts/gen_be/gen_be_wrapper.ksh

### C.  running  gen_be_wrapper.ksh


#### i).  link 
gen_be_wrapper.ksh to your working directory: $WRKDIR/wrfda
```bash
ln -sf $WRFDA/var/scripts/gen_be/gen_be_wrapper.ksh $WRKDIR/wrfda
```

#### ii).  vi gen_be_wrapper.ksh
```bash
 export WRFVAR_DIR=/home/chchoi/arw/WRFDA
 export NL_CV_OPTIONS=5                      # 5 for CV5, 7 for CV7
 export START_DATE=2017061212         # the first perturbation valid date
 export END_DATE=2017061220            # the last perturbation valid date
 export NUM_LEVELS=29                        # e_vert - 1
 export BIN_TYPE=5                                 # How data is binned for calculating statistics
 export FC_DIR=/home/chchoi/arw/wrf_run/wrf                          # where wrf forecasts are
 export RUN_DIR=/home/chchoi/arw/wrf_run/wrfda/gen_be      # Where GEN_BE will run and output files
```







 